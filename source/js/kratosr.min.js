let kr={};window.requestIdleCallback=window.requestIdleCallback||function(e){let t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)},(()=>{const e=()=>{$(document).on("click",".xHeading",(function(e){$(this).next().slideToggle(300),$(this).parent(".xControl").hasClass("active")?$(this).parent(".xControl").removeClass("active"):$(this).parent(".xControl").addClass("active"),e.preventDefault()}))},t=()=>{$(document).on("click",".donate",(()=>{layer.open({type:1,area:["300px","370px"],title:kr.donateBtn,resize:!1,scrollbar:!1,content:'<div class="donate-box"><div class="meta-pay text-center"><strong>'+kr.scanNotice+'</strong></div><div class="qr-pay text-center"><img class="pay-img" id="alipay_qr" src="'+kr.qr_alipay+'"><img class="pay-img d-none" id="wechat_qr" src="'+kr.qr_wechat+'"></div><div class="choose-pay text-center mt-2"><input id="alipay" type="radio" name="pay-method" checked><label for="alipay" class="pay-button"><img src="/images/alipay.webp"></label><input id="wechatpay" type="radio" name="pay-method"><label for="wechatpay" class="pay-button"><img src="/images/wechat.webp"></label></div></div>'}),$(".choose-pay input[type='radio']").click((function(){const e=$(this).attr("id");"alipay"==e&&($(".qr-pay #alipay_qr").removeClass("d-none"),$(".qr-pay #wechat_qr").addClass("d-none")),"wechatpay"==e&&($(".qr-pay #alipay_qr").addClass("d-none"),$(".qr-pay #wechat_qr").removeClass("d-none"))}))}))},n=()=>{void 0!==$.fancybox&&($.fancybox.defaults.hash=!1,$(".kratos-hentry").each((function(e){$(this).find("img").each((function(){if($(this).parent().hasClass("fancybox")||$(this).parent().hasClass("qrcode")||$(this).parent().is("a"))return;const e=this.alt;e&&$(this).after('<span class="caption">'+e+"</span>"),$(this).wrap('<a rel="gallery" href="'+this.src+'" data-fancybox="gallery" data-caption="'+e+'"></a>')}))})),$(".fancybox").fancybox())},o=()=>{$(document).on("click","a[class=toc-link]",(function(){return $("html, body").animate({scrollTop:$(decodeURI($(this).attr("href"))).offset().top-60},500),!1}))};let a;let r="";const s=(e,t=!0)=>{let n;const o=e/1e3,a=Math.floor(o/60/60/24),r=Math.floor(o/60/60-24*a),s=Math.floor(o/60-1440*a-60*r),i=Math.floor(o-86400*a-3600*r-60*s);let l=a.toString(),c=r.toString(),d=s.toString(),m=i.toString();return t?(l&&1===l.length&&(l="0"+l),c&&1===c.length&&(c="0"+c),d&&1===d.length&&(d="0"+d),m&&1===m.length&&(m="0"+m),n=l+"天"+c+"小时"+d+"分"+m+"秒"):n=a<540?a<60?l+"天":Math.floor(a/30).toString()+"个月":Math.floor(a/365).toString()+"年",n},i=(e,t)=>{var n=0;return function(){var o=this,a=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(o,a)}),t||0)}},l=()=>{(()=>{const e=document.getElementsByClassName("kratos-entry-thumb-new-img"),t=kr.cover&&kr.cover.randomAmount||20,n=kr.cover&&kr.cover.baseUrl||"https://cdn.jsdelivr.net/npm/hexo-theme-kratos-rebirth@latest/source/images/thumb/",o=kr.cover&&kr.cover.filenameTemplate||"thumb_{no}.webp",a=new Array(t+1),r=()=>{let e,n=5;for(;n>0&&(e=Math.floor(Math.random()*t+1),a[e]);)n--;if(n<=0){e=-1;for(let n=1;n<=t;n++)if(!a[n]){e=n;break}if(-1===e){for(let e=1;e<=t;e++)a[e]=!1;e=Math.floor(Math.random()*t+1)}}return a[e]=!0,e};for(let t=0,a=e.length;t<a;t++)if(!$(e[t]).attr("src")){const a=r(),s=o.replace("{no}",a.toString());let i;i=s.includes("//")?s:"/"===n.substring(n.length-1)?n+s:n+"/"+s,$(e[t]).attr("src",i)}})(),n(),a=`\n\n-------------------------\n${kr.copyrightNotice}\n作者：${document.querySelector("meta[name='author']").getAttribute("content")}\n来源：${document.title}\n链接：${window.location.href}\n`,r=document.title,"undefined"!=typeof MathJax&&MathJax.Hub.Typeset(),document.querySelectorAll("figure.highlight").forEach(((e,t)=>{e.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByClassName("code")[0].setAttribute("id",`code-${t}`),e.innerHTML+=`<button class="copy" data-clipboard-target="#code-${t}">\n                <i class="fa fa-copy"></i>&nbsp;复制\n            </button>`})),new ClipboardJS("button.copy").on("success",(e=>{const t=e.trigger.innerHTML;e.trigger.innerHTML='<i class="fa fa-check-circle"></i>&nbsp;成功~',setTimeout((()=>{e.trigger.innerHTML=t}),3e3),e.clearSelection()})),(()=>{const e="undefined"!=typeof window,t=e&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),n=e&&"IntersectionObserver"in window,o=document.querySelector(".post-comments.lazy-load"),a=()=>{window.loadCommentsEventHandler&&window.cancelIdleCallback(window.loadCommentsEventHandler),window.loadCommentsEventHandler=window.requestIdleCallback(load_comm),load_comm=null};if(e&&!t&&n&&null!==o){const e=new IntersectionObserver((t=>{t[0].isIntersecting&&(a(),e.disconnect())}),{threshold:0});e.observe(o)}else"undefined"!=typeof load_comm&&null!==load_comm&&a()})(),(()=>{if(kr.expire_day){const e=document.getElementById("expire-alert");if(e){const t=e.querySelector("time"),n=new Date(parseInt(t.getAttribute("datetime"))),o=Date.now()-n;o>24*kr.expire_day*3600*1e3&&(t.innerText=s(o,!1),e.classList.remove("hidden"))}}})(),(()=>{if(null!==document.getElementById("krw-toc")){const e=document.getElementById("krw-toc").getElementsByClassName("toc-item"),t=[];try{Array.from(e).forEach((e=>{const n=e.querySelector(".toc-link"),o=decodeURI(n.getAttribute("href"));if("#"!=o.substring(0,1))throw new Error("TOC 小标题链接无效，格式无限");const a=document.getElementById(o.substring(1));if(!a)throw new Error("TOC 小标题链接无效，未找到相关引用");a.setAttribute("data-toc-id",t.length),t.push({at:a,el:e})}))}catch(t){return console.log("错误：",t.message),void Array.from(e).forEach((e=>{e.classList.add("show")}))}let n=-1;const o=e=>{if(n!==e){if(-1!==n){t[n].el.classList.remove("active"),t[n].el.classList.remove("show");let e=t[n].el;for(;!e.classList.contains("toc");)e.classList.contains("toc-item")&&e.classList.remove("show"),e=e.parentNode}if(-1!==e){t[e].el.classList.add("active"),t[e].el.classList.add("show");let n=t[e].el;for(;!n.classList.contains("toc");)n.classList.contains("toc-item")&&n.classList.add("show"),n=n.parentNode}n=e}};if("IntersectionObserver"in window){const e=i(((t,n)=>{n===window.scrollY?window.requestAnimationFrame((()=>{o(t)})):e(t,window.scrollY)}),100),n=new IntersectionObserver((t=>{let n=null;t.forEach((e=>{const t=Number.parseInt(e.target.getAttribute("data-toc-id"),10);!e.isIntersecting&&e.boundingClientRect.top<=e.rootBounds.top?n=t:e.isIntersecting&&e.boundingClientRect.bottom<e.rootBounds.top+e.rootBounds.height/2&&1===e.intersectionRatio&&(n=t-1)})),null!==n&&e(n,window.scrollY)}),{rootMargin:"-62px 0px 0px 0px",threshold:1});t.forEach((e=>{n.observe(e.at)})),window.addEventListener("pjax:before",(()=>{n.disconnect(),t.length=0}),{once:!0})}else{const e=()=>{t.forEach((e=>{e.h=e.at.getBoundingClientRect().top+window.scrollY-61}))};e();const a=()=>{let e;e=!Number.isInteger(n)||n<0||n>t.length-1?0:n;const o=window.scrollY;if(o>=t[e].h)if(o>=t[t.length-1].h)e=t.length-1;else for(;o>=t[e+1].h;)e++;else for(;o<t[e].h&&(e--,!(e<0)););return e},r=i((()=>{window.requestAnimationFrame((()=>{o(a())}))}),100),s=i((()=>{e(),window.requestAnimationFrame((()=>{o(a())}))}),100);window.addEventListener("resize",s),window.addEventListener("scroll",r),window.addEventListener("pjax:before",(()=>{window.removeEventListener("resize",s),window.removeEventListener("scroll",r),t.length=0}),{once:!0})}const a=document.getElementsByClassName("toc-progress-bar")[0],r=document.querySelector(".kratos-post-content"),s=()=>{if(r){const e=window.scrollY||document.documentElement.scrollTop,t=r.clientHeight,n=document.documentElement.clientHeight,o=r.offsetTop,s=t>n?t-n:document.documentElement.scrollHeight-n,i=Math.max(0,Math.min((e-o)/s,1)),l=Math.round(100*i);a.style.width=(100*i).toString()+"%",a.setAttribute("aria-valuenow",l)}};window.addEventListener("scroll",(()=>{window.requestAnimationFrame(s)})),s()}})()},c=()=>{l(),kr.copyrightNotice&&(document.body.oncopy=e=>{const t=window.getSelection().toString();t.length>150&&(e.preventDefault(),e.clipboardData&&e.clipboardData.setData("text/plain",t+a))}),(()=>{if(kr.siteLeaveEvent){let e;const t=$('[rel="icon"]').attr("href");document.addEventListener("visibilitychange",(()=>{document.hidden?(document.title=kr.leaveTitle,kr.leaveLogo&&$('[rel="icon"]').attr("href",kr.leaveLogo),clearTimeout(e)):(document.title=kr.returnTitle+" "+r,kr.leaveLogo&&$('[rel="icon"]').attr("href",t),e=setTimeout((()=>{document.title=r,e=0}),2e3))}))}})(),(()=>{const e=new Date(kr.createTime),t=document.getElementById("span_dt");setInterval((()=>{t.innerText=s(Date.now()-e)}),1e3)})(),t(),(()=>{if(!kr.topNavScrollToggle)return;let e=window.innerHeight,t=!1;window.addEventListener("wheel",(()=>{window.requestAnimationFrame((()=>{e<window.scrollY?t||(document.body.classList.add("nav-up"),t=!0):e>window.scrollY&&t&&(document.body.classList.remove("nav-up"),t=!1),e=window.scrollY}))}))})()};window.addEventListener("pjax:complete",l),window.addEventListener("window:onload",(()=>{var t;t=c,fetch((window.kr?.siteRoot||"/")+"config/main.json").then((e=>e.json())).then((e=>{kr=e})).then((()=>{t()})),(()=>{let e=!1;const t=()=>{window.requestAnimationFrame((()=>{window.scrollY>200?e||(document.body.classList.add("scroll-down"),e=!0):e&&(document.body.classList.remove("scroll-down"),e=!1)}))};$(".gotop-box").on("click",(function(e){return $("html, body").animate({scrollTop:$("html").offset().top},500),!1})),t(),window.addEventListener("scroll",t)})(),(()=>{let e=$("#kratos-menu-wrap").clone();e.attr({id:"offcanvas-menu"}),e.find("> ul").attr({id:""}).addClass("ul-me"),$("#kratos-page").prepend(e),$(".js-kratos-nav-toggle").on("click",(()=>{$(".nav-toggle").hasClass("toon")?($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px")):($(".nav-toggle").addClass("toon"),$("#offcanvas-menu").css("right","0px"))})),$("#offcanvas-menu").css("height",$(window).height()),$("#offcanvas-menu").css("right","-240px"),$(window).resize((()=>{const e=$(window);$("#offcanvas-menu").css("height",e.height()),e.width()>769&&$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))}))})(),$(document).click((e=>{const t=$("#offcanvas-menu,.js-kratos-nav-toggle");t.is(e.target)||0!==t.has(e.target).length||$(".nav-toggle").hasClass("toon")&&($(".nav-toggle").removeClass("toon"),$("#offcanvas-menu").css("right","-240px"))})),e(),$(document).on("click",".share",(()=>{$(".share-wrap").fadeToggle("slow")})),o()}),{once:!0}),window.onload=()=>{window.dispatchEvent(new Event("window:onload")),console.log("页面加载完毕！消耗了 %c"+Math.round(100*performance.now())/100+" ms","background:#282c34;color:#51aded;")}})();
//# sourceMappingURL=../maps/kratosr.min.js.map
